# WEAVER.ai - Migration Instructions

## Project Overview
This project has been ported from a client-side prototype to a full Next.js 14 application using the App Router.
It uses Firebase for authentication/database (mocked by default) and the Google GenAI SDK for content generation.

## Prerequisites
- Node.js 18+
- npm or yarn

## Setup Steps

1. **Hydrate the Codebase**
   Run the included shell script to generate the project files:
   ```bash
   chmod +x create_weaver_app.sh
   ./create_weaver_app.sh
   cd weaver-ai
   ```

2. **Install Dependencies**
   The `package.json` is generated, but you need to install the packages:
   ```bash
   npm install
   ```

3. **Environment Configuration**
   Rename `.env.local.example` to `.env.local` and fill in your keys:
   - `NEXT_PUBLIC_GEMINI_API_KEY`: Get this from Google AI Studio.
   - `NEXT_PUBLIC_FIREBASE_CONFIG`: Get this JSON string from Firebase Console (Project Settings).

4. **Gemini 3.0 / 2.0 Flash Update**
   The code is currently configured to use `gemini-2.0-flash-exp` as a proxy for the next generation model.
   Check `components/editor/EditableBlock.tsx`, `components/book/CharacterModal.tsx`, etc., to verify the model string:
   ```javascript
   model: 'gemini-2.0-flash-exp' // Update to 'gemini-3.0-pro' when available
   ```

5. **Run Development Server**
   ```bash
   npm run dev
   ```

## Architecture Notes
- **Routing**: Uses Next.js App Router (`app/`).
- **Styling**: Tailwind CSS with a `dark` class toggle.
- **State**: `UserContext` handles global auth and data state (Credits, Books, etc.).
- **Auth**: `AuthInitializer` component in `layout.tsx` handles Firebase listeners globally.

## Future Tasks for the Agent
1. **Server Actions**: Move the `GoogleGenAI` calls from the client components (`EditableBlock`, `GeneratorPage`) to Server Actions for better security (hiding the API key).
2. **Firestore Sync**: The current `firebase.ts` has a strong Mock DB fallback. Ensure the Firestore security rules are set up and `isDemoMode` is false in production.
3. **Editor Page**: The `/app/editor/[id]/page.tsx` is currently a placeholder. Build out the full-screen article editor.
